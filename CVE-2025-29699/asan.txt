=================================================================
==148198==ERROR: AddressSanitizer: heap-use-after-free on address 0x50e0000648b8 at pc 0x558162722adc bp 0x7ffff5e95e50 sp 0x7ffff5e95e48
READ of size 8 at 0x50e0000648b8 thread T0
    #0 0x558162722adb in _dom_node_dispatch_node_change_event /home/ubuntu/dev-netsurf/workspace-fresh/libdom/src/core/node.c:2604:17
    #1 0x558162722adb in _dom_node_remove_child /home/ubuntu/dev-netsurf/workspace-fresh/libdom/src/core/node.c:988:8
    #2 0x558162724411 in dom_node_remove_child /home/ubuntu/dev-netsurf/workspace-fresh/libdom/include/dom/core/node.h:360:9
    #3 0x558162724411 in _dom_node_set_text_content /home/ubuntu/dev-netsurf/workspace-fresh/libdom/src/core/node.c:1496:9
    #4 0x55816226d0cd in dom_node_set_text_content /home/ubuntu/dev-netsurf/workspace/inst-x86_64-linux-gnu/include/dom/core/node.h:491:9
    #5 0x55816226d0cd in dukky_node_textContent_setter /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/Node.bnd:254:8
    #6 0x5581624a9bed in duk__handle_call_raw /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c
    #7 0x55816242da84 in duk_handle_call_unprotected /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:68507:9
    #8 0x55816242da84 in duk_call_method /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15357:2
    #9 0x55816242da84 in duk_hobject_putprop /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:61874:4
    #10 0x5581624c3635 in duk__js_execute_bytecode_inner /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c
    #11 0x5581624ae5b2 in duk_js_execute_bytecode /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:80167:4
    #12 0x5581624a9cbd in duk__handle_call_raw /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:68335:3
    #13 0x5581623ede4b in duk_handle_call_unprotected /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:68507:9
    #14 0x5581623ede4b in duk__pcall_method_raw /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15430:8
    #15 0x5581623952af in duk__handle_safe_call_inner /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:68560:7
    #16 0x5581623952af in duk_handle_safe_call /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:68806:3
    #17 0x558162394876 in duk_safe_call /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15525:7
    #18 0x558162394876 in duk_pcall_method_flags /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15449:9
    #19 0x558162394876 in duk_pcall_method /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15455:9
    #20 0x55816238a59a in js_fire_event /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/dukky.c:1649:6
    #21 0x5581623120ee in html_finish_conversion /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/html/html.c:385:3
    #22 0x5581623138b3 in html_begin_conversion /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/html/html.c:997:3
    #23 0x5581622ff8f5 in html_convert_css_callback /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/html/css.c:140:3
    #24 0x558162502a36 in hlcache_content_callback /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/hlcache.c:205:11
    #25 0x55816229d11a in content_broadcast /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/content.c:762:4
    #26 0x55816229d11a in content_set_done /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/content.c:308:2
    #27 0x5581622c570e in nscss_content_done /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/css/css.c:509:2
    #28 0x5581622c4a5a in nscss_convert_css_data /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/css/css.c:324:3
    #29 0x5581622c4a5a in nscss_convert /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/css/css.c:292:10
    #30 0x55816229c757 in content_convert /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/content.c:84:7
    #31 0x55816229c757 in content_llcache_callback /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/content.c:140:4
    #32 0x55816251179c in llcache_object_notify_users /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/llcache.c:3530:12
    #33 0x558162510c67 in llcache_catch_up_all_users /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/llcache.c:3692:3
    #34 0x5581625c9310 in schedule_run /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/frontends/gtk/schedule.c:148:25
    #35 0x5581625aca54 in nsgtk_main /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/frontends/gtk/gui.c:1073:3
    #36 0x5581625aca54 in main /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/frontends/gtk/gui.c:1233:2
    #37 0x7f4bbb41ed8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #38 0x7f4bbb41ee3f in __libc_start_main csu/../csu/libc-start.c:392:3
    #39 0x5581620cbbd4 in _start (/home/ubuntu/dev-netsurf/workspace-fresh/netsurf/nsgtk3+0x1abbd4)

0x50e0000648b8 is located 56 bytes inside of 152-byte region [0x50e000064880,0x50e000064918)
freed by thread T0 here:
    #0 0x558162165ba6 in free /home/ubuntu/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x558162725ca9 in dom_node_destroy /home/ubuntu/dev-netsurf/workspace-fresh/libdom/src/core/node.h:249:2
    #2 0x558162725ca9 in _dom_node_try_destroy /home/ubuntu/dev-netsurf/workspace-fresh/libdom/src/core/node.c:2269:4
    #3 0x55816226d0cd in dom_node_set_text_content /home/ubuntu/dev-netsurf/workspace/inst-x86_64-linux-gnu/include/dom/core/node.h:491:9
    #4 0x55816226d0cd in dukky_node_textContent_setter /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/Node.bnd:254:8
    #5 0x5581624a9bed in duk__handle_call_raw /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c
    #6 0x55816242da84 in duk_handle_call_unprotected /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:68507:9
    #7 0x55816242da84 in duk_call_method /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15357:2
    #8 0x55816242da84 in duk_hobject_putprop /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:61874:4
    #9 0x5581624c3635 in duk__js_execute_bytecode_inner /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c
    #10 0x5581624ae5b2 in duk_js_execute_bytecode /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:80167:4
    #11 0x5581624a9cbd in duk__handle_call_raw /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:68335:3
    #12 0x5581623ede4b in duk_handle_call_unprotected /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:68507:9
    #13 0x5581623ede4b in duk__pcall_method_raw /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15430:8
    #14 0x558162394876 in duk_safe_call /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15525:7
    #15 0x558162394876 in duk_pcall_method_flags /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15449:9
    #16 0x558162394876 in duk_pcall_method /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/duktape.c:15455:9
    #17 0x558162388f25 in dukky_generic_event_handler /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/handlers/javascript/duktape/dukky.c:1300:7
    #18 0x55816273ec5d in _dom_event_target_dispatch /home/ubuntu/dev-netsurf/workspace-fresh/libdom/src/events/event_target.c:236:6

previously allocated by thread T0 here:
    #0 0x558162165e3f in malloc /home/ubuntu/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3
    #1 0x558162778c2e in _dom_text_create /home/ubuntu/dev-netsurf/workspace-fresh/libdom/src/core/text.c:83:6
    #2 0x5581627181aa in dom_document_create_text_node /home/ubuntu/dev-netsurf/workspace-fresh/libdom/include/dom/core/document.h:187:9
    #3 0x5581627181aa in create_text /home/ubuntu/dev-netsurf/workspace-fresh/libdom/bindings/hubbub/parser.c:297:8
    #4 0x55816279eb7b in append_text /home/ubuntu/dev-netsurf/workspace-fresh/libhubbub/src/treebuilder/treebuilder.c:888:10
    #5 0x5581627a6944 in process_character /home/ubuntu/dev-netsurf/workspace-fresh/libhubbub/src/treebuilder/in_body.c:216:9
    #6 0x5581627a6944 in handle_in_body /home/ubuntu/dev-netsurf/workspace-fresh/libhubbub/src/treebuilder/in_body.c:143:9
    #7 0x55816279df49 in hubbub_treebuilder_token_handler /home/ubuntu/dev-netsurf/workspace-fresh/libhubbub/src/treebuilder/treebuilder.c:246:10
    #8 0x55816277c592 in hubbub_parser_parse_chunk /home/ubuntu/dev-netsurf/workspace-fresh/libhubbub/src/parser.c:248:10
    #9 0x55816229c11d in content_llcache_callback /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/content.c:120:8
    #10 0x55816251155c in llcache_object_notify_users /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/llcache.c:3496:12
    #11 0x558162510c67 in llcache_catch_up_all_users /home/ubuntu/dev-netsurf/workspace-fresh/netsurf/content/llcache.c:3692:3
    #12 0x7f4bbb41ed8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16

SUMMARY: AddressSanitizer: heap-use-after-free /home/ubuntu/dev-netsurf/workspace-fresh/libdom/src/core/node.c:2604:17 in _dom_node_dispatch_node_change_event
Shadow bytes around the buggy address:
  0x50e000064600: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fa
  0x50e000064680: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00
  0x50e000064700: 00 00 00 00 00 00 00 00 00 00 00 fa fa fa fa fa
  0x50e000064780: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 00
  0x50e000064800: 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa fa
=>0x50e000064880: fd fd fd fd fd fd fd[fd]fd fd fd fd fd fd fd fd
  0x50e000064900: fd fd fd fa fa fa fa fa fa fa fa fa 00 00 00 00
  0x50e000064980: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fa
  0x50e000064a00: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00
  0x50e000064a80: 00 00 00 00 00 00 00 00 00 00 00 fa fa fa fa fa
  0x50e000064b00: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==148198==ABORTING
