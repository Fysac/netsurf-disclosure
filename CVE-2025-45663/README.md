# CVE-2025-45663

This issue affects NetSurf <= 3.11 and libdom prior to commit [9ea069f36e5de5f52d7155a71e2d536eb94de141](https://github.com/netsurf-browser/libdom/commit/9ea069f36e5de5f52d7155a71e2d536eb94de141).

In `_dom_event_initialise`, several JavaScript-accessible fields of the `dom_event` structure are left uninitialized, including `phase`, `timestamp`, `bubble`, and `cancelable`. `phase` is an integer with an implemented JavaScript getter (`event.eventPhase`), which means that scripts can read it. It appears to leak the lower four bytes of a valid heap address on 64-bit systems. While likely not exploitable on its own, this bug may serve as a partial information leak primitive for other exploits.

```c
dom_exception _dom_event_initialise(dom_event *evt)
{
	evt->stop = false;
	evt->stop_now = false;
	evt->prevent_default = false;
	evt->custom = false;

	evt->type = NULL;

	evt->namespace = NULL;

	evt->refcnt = 1;
	evt->in_dispatch = false;
	evt->is_initialised = false;
	evt->is_trusted = true;

	return DOM_NO_ERR;
}
```

Reference: https://github.com/netsurf-browser/libdom/blob/a2ffae698d4c12d9457c62b79eddd4342e2e213c/src/events/event.c#L46-L63

Sample console output from [PoC](poc.html):

```
(0.055518) [VERB netsurf] desktop/browser_window.c:4647 browser_window_console_log: 0x335a7980
(0.055528) [VERB netsurf] desktop/browser_window.c:4647 browser_window_console_log: 0x335a7bb0
(0.055538) [VERB netsurf] desktop/browser_window.c:4647 browser_window_console_log: 0x335a7de0
```